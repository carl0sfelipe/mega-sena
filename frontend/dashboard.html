<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - Bol√£o Mega da Virada</title>
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/matrix.css">
</head>
<body>
  <div class="dashboard">
    <header class="dashboard-header">
      <div>
        <h1>üé≤ Bol√£o Mega da Virada 2026</h1>
        <p class="bolao-subtitle">Sistema de sele√ß√£o inteligente</p>
      </div>
      <div class="user-info">
        <span id="userName" class="user-name"></span>
        <a href="/admin.html" id="adminPanelBtn" class="btn btn-primary btn-sm" style="display: none;">
          ‚öôÔ∏è Painel Admin
        </a>
        <button id="logoutBtn" class="btn btn-secondary btn-sm">Sair</button>
      </div>
    </header>

    <main class="dashboard-main">
      <!-- Payment Section -->
      <section id="paymentSection" class="card payment-section" style="display: none;">
        <h2>üí∞ Pagamento</h2>
        <div class="payment-details">
          <div class="quota-selector">
            <label for="quotaQuantity"><strong>Quantas cotas deseja comprar?</strong></label>
            <div class="quota-input-group">
              <input type="number" id="quotaQuantity" min="1" max="10" value="1" class="quota-input">
              <span class="quota-info">
                <span id="quotaUnitValue">R$ 10,00</span> por cota
              </span>
            </div>
            <p class="total-amount">
              <strong>Total a pagar:</strong> R$ <span id="totalAmount">10,00</span>
            </p>
          </div>

          <div class="pix-payment-box">
            <h3>üí∞ Pagamento via PIX</h3>
            <p><strong>Chave PIX:</strong> <code class="pix-key-display">b853b083-72c3-444b-9224-7cb0d6e7a724</code></p>
            <div class="qr-code-container">
              <img
                src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=b853b083-72c3-444b-9224-7cb0d6e7a724"
                alt="QR Code PIX"
                class="qr-code"
              />
            </div>
            <p class="pix-hint">Escaneie o QR Code ou copie a chave PIX acima</p>
          </div>
        </div>

        <div id="paymentActions">
          <button id="joinBolaoBtn" class="btn btn-primary" style="display: none;">
            Participar do Bol√£o
          </button>
          <button id="alreadyPaidBtn" class="btn btn-success" style="display: none;">
            J√° Paguei via PIX
          </button>
        </div>

        <div id="paymentStatus" class="status-message"></div>
      </section>
      <!-- Waiting Section -->
      <section id="waitingSection" class="card waiting-section" style="display: none;">
        <h2>‚è≥ Aguardando Confirma√ß√£o</h2>
        <p>Seu pagamento foi registrado e est√° aguardando confirma√ß√£o do administrador.</p>
        <p class="info-text">Voc√™ ser√° notificado assim que for confirmado e poder√° selecionar seus n√∫meros da sorte.</p>
      </section>

      <!-- Number Selection Section -->
      <section id="selectionSection" class="card selection-section" style="display: none;">
        <h2>üéØ Selecione seus N√∫meros da Sorte</h2>

        <!-- Selection Mode Choice -->
        <div class="selection-mode-choice">
          <p class="mode-question">Como voc√™ quer escolher seus n√∫meros?</p>
          <div class="mode-buttons">
            <button id="autoGenerateBtn" class="btn btn-success mode-btn">
              üé≤ Gerar Automaticamente
              <span class="mode-description">Sistema escolhe os 6 melhores n√∫meros baseado no algoritmo</span>
            </button>
            <button id="manualSelectBtn" class="btn btn-primary mode-btn">
              ‚úã Escolher Manualmente
              <span class="mode-description">Voc√™ escolhe at√© 6 n√∫meros que preferir</span>
            </button>
          </div>
        </div>

        <!-- Manual Selection Area -->
        <div id="manualSelectionArea" style="display: none;">
          <div class="explanation-box">
            <h3>üí° Entendendo as Cores e Pontua√ß√µes</h3>
            <p><strong>O sistema anti-padr√£o analisa cada n√∫mero de 1 a 60 e atribui uma pontua√ß√£o (0-100) baseada em:</strong></p>
            <ul>
              <li>
                <strong>üìä Frequ√™ncia Hist√≥rica (40 pontos):</strong>
                Quantas vezes o n√∫mero saiu nos 2.951 sorteios hist√≥ricos.
                N√∫meros que saem mais frequentemente ganham mais pontos.
              </li>
              <li>
                <strong>üë• Popularidade Invertida (40 pontos):</strong>
                Quantos usu√°rios do bol√£o escolheram este n√∫mero (quanto MENOS escolhido, MAIOR a pontua√ß√£o).
                Isso evita dividir pr√™mios com muita gente.
              </li>
              <li>
                <strong>‚ö†Ô∏è Penalidades Anti-Padr√£o (at√© -20 pontos):</strong>
                <ul>
                  <li>N√∫meros 1-31: -10 pontos (vi√©s de anivers√°rios)</li>
                  <li>M√∫ltiplos de 5 (5, 10, 15...): -5 pontos</li>
                  <li>M√∫ltiplos de 10 (10, 20, 30...): -5 pontos adicionais</li>
                </ul>
              </li>
            </ul>

            <div class="color-explanation">
              <h4>Significado das Cores:</h4>
              <div class="color-examples">
                <div class="color-example">
                  <span class="color-box score-high"></span>
                  <div>
                    <strong>Verde (80-100 pontos):</strong>
                    N√∫meros altamente recomendados. Alta frequ√™ncia hist√≥rica, pouco escolhidos e sem padr√µes humanos.
                  </div>
                </div>
                <div class="color-example">
                  <span class="color-box score-medium"></span>
                  <div>
                    <strong>Amarelo (50-79 pontos):</strong>
                    N√∫meros medianos. Podem ter boa frequ√™ncia mas s√£o mais populares, ou vice-versa.
                  </div>
                </div>
                <div class="color-example">
                  <span class="color-box score-low"></span>
                  <div>
                    <strong>Vermelho (0-49 pontos):</strong>
                    N√∫meros menos recomendados. Geralmente s√£o datas (1-31), m√∫ltiplos redondos ou muito populares.
                  </div>
                </div>
              </div>
            </div>
          </div>

          <p class="instructions">
            <strong>Clique nos n√∫meros para selecion√°-los (m√°ximo 6 n√∫meros).</strong>
            Passe o mouse sobre cada n√∫mero para ver detalhes da pontua√ß√£o.
          </p>

          <div id="numberMatrix" class="number-matrix">
            <!-- Numbers will be generated by JavaScript -->
          </div>

          <div class="selected-summary">
            <h3>N√∫meros Selecionados: <span id="selectedCount">0</span>/6</h3>
            <div id="selectedList" class="selected-list"></div>
          </div>

          <button id="saveSelectionsBtn" class="btn btn-primary">
            üíæ Salvar Sele√ß√µes
          </button>
        </div>

        <!-- Auto Generated Display -->
        <div id="autoGeneratedArea" style="display: none;">
          <div class="auto-result">
            <h3>‚úÖ N√∫meros Gerados Automaticamente</h3>
            <p>O sistema selecionou 6 n√∫meros baseado no algoritmo anti-padr√£o com sorteio ponderado:</p>
            <div id="autoGeneratedList" class="auto-generated-numbers"></div>
            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
              <button id="regenerateBtn" class="btn btn-primary">
                üîÑ Gerar Novamente
              </button>
              <button id="saveAutoBtn" class="btn btn-success">
                üíæ Confirmar e Salvar
              </button>
              <button id="changeToManualBtn" class="btn btn-secondary">
                ‚úã Prefiro Escolher Manualmente
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- Bolao Info Section -->
      <section class="card info-section">
        <h3>üìä Status do Bol√£o</h3>
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">Participantes confirmados:</span>
            <span class="info-value" id="confirmedCount">-</span>
          </div>
          <div class="info-item">
            <span class="info-label">Total arrecadado:</span>
            <span class="info-value">R$ <span id="totalFunds">0,00</span></span>
          </div>
        </div>
      </section>
    </main>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
      <div class="spinner"></div>
      <p>Carregando...</p>
    </div>

    <!-- Toast Notifications -->
    <div id="toast" class="toast" style="display: none;"></div>
  </div>

  <script src="js/api.js"></script>
  <script src="js/matrix.js"></script>
  <script src="js/dashboard.js"></script>
</body>
</html>
